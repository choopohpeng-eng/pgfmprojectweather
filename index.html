<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Singapore 2-hr Nowcast Weather Information</title>

  <!-- CSS Link -->
  <!--<link rel="stylesheet" href="style.css"> -->

  <!-- Optional: Google Fonts -->
  <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap" rel="stylesheet">

    <style>
     * {
      box-sizing: border-box;
    }

    body {
      font-family: Arial, sans-serif;
      background: #f5f7fa;
      margin: 0;
      padding: 0;
      overflow: hidden; /* prevent whole page scroll */
    }

    header {
      background: #0078d7;
      color: white;        
      padding: 15px 0;
      font-size: 1.8em;
      text-align: center;
      font-weight: bold;
      position: fixed;
      top: 0;
      width: 100%;
      z-index: 1000;
      box-shadow: 0 3px 8px rgba(0,0,0,0.2);
    }

    .weather-display {
      background: #fff;
      border-radius: 12px;
      box-shadow: 0 4px 10px rgba(0,0,0,0.1);
      padding: 15px;
      margin: 0 auto;
      max-width: 600px;
      text-align: center;
      position: fixed;
      top: 70px;
      left: 50%;
      transform: translateX(-50%);
      width: 90%;
      z-index: 999;
    }

    .weather-icon {
      font-size: 3em;
      margin: 10px 0;
    }

    /* Scrollable region grid area */
    .region-container {
      position: absolute;
      top: 300px; /* Below header + weather box */
      bottom: 0;
      width: 100%;
      overflow-y: auto;
      padding: 20px 10px;
    }

    /* Flexbox grid */
    .region-table {
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      gap: 15px;
      max-width: 1200px;
      margin: auto;
    }

    .small-flexbox {
      display: flex;
      align-items: center;
      justify-content: center;
      width: calc(20% - 15px); /* 5 columns */
      min-width: 150px;
    }

    .card {
      background: white;
      border-radius: 12px;
      box-shadow: 0 4px 10px rgba(0,0,0,0.1);
      padding: 10px 5px;
      width: 100%;
      min-height: 4cqb;
      display: flex;
      justify-content: center;
      align-items: center;
      transition: transform 0.2s, box-shadow 0.2s, background-color 0.2s;
      cursor: pointer;
    }

    .card:hover {
      transform: translateY(-4px);
      box-shadow: 0 8px 16px rgba(0,0,0,0.15);
      background: #e8f4ff;
    }

    .region-name {
      font-size: 1em;
      color: #333;
      font-weight: 500;
    }

    /* Highlight selected region */
    .selected {
      background: #0078d7 !important;
      color: white !important;
      box-shadow: 0 0 10px rgba(0,120,215,0.5);
    }

    @media (max-width: 768px) {
      .small-flexbox {
        width: calc(33.33% - 15px);
      }
    }

    @media (max-width: 480px) {
      .small-flexbox {
        width: calc(50% - 15px);
      }
    }
  </style>

</head>

<body>

  <header>Singapore 2-Hour Weather Forecast</header>

  <div class="weather-display">
    <h2 id="region-name">Select a region for the weather information</h2>
    <div id="weather-icon" class="weather-icon">ğŸŒˆ</div>
    <div id="weather-info">The weather information for the selected region will appear here</div>
    <div id="time-info"></div>
  </div>

  <div class="region-container">
    <div id="region-table" class="region-table"></div>
  </div>

  <script>
    const regionName = document.getElementById("region-name");
    const weatherIcon = document.getElementById("weather-icon");
    const weatherInfo = document.getElementById("weather-info");
    const timeInfo = document.getElementById("time-info");
    
    const regionTable = document.getElementById("region-table");

    const weatherEmojis = {
      "Fair": "â˜€ï¸", 
      "Fair (Day)": "ğŸŒ¤ï¸", 
      "Fair (Night)": "ğŸŒ™",
      "Fair and Warm": "â˜€ï¸", 
      "Partly Cloudy": "â›…",
      "Partly Cloudy (Day)": "ğŸŒ¤ï¸", 
      "Partly Cloudy (Night)": "ğŸŒ™â˜ï¸",
      "Cloudy": "â˜ï¸", 
      "Hazy": "ğŸŒ«ï¸", 
      "Slightly Hazy": "ğŸŒ«ï¸",
      "Windy": "ğŸŒ¬ï¸", 
      "Mist": "ğŸŒ«ï¸", 
      "Fog": "ğŸŒ«ï¸",
      "Light Rain": "ğŸŒ¦ï¸", 
      "Moderate Rain": "ğŸŒ§ï¸", 
      "Heavy Rain": "ğŸŒ§ï¸ğŸŒ§ï¸",
      "Passing Showers": "ğŸŒ¦ï¸", 
      "Light Showers": "ğŸŒ¦ï¸", 
      "Showers": "ğŸŒ¦ï¸",
      "Heavy Showers": "ğŸŒ§ï¸", 
      "Thundery Showers": "â›ˆï¸",
      "Heavy Thundery Showers": "ğŸŒ©ï¸",
      "Heavy Thundery Showers with Gusty Winds": "ğŸŒªï¸"
    };

    const regions = [
      "Ang Mo Kio", "Bedok", "Bishan", "Boon Lay", "Bukit Batok", "Bukit Merah", "Bukit Panjang", "Bukit Timah",
      "Central Water Catchment", "Changi", "Choa Chu Kang", "Clementi", "City", "Geylang", "Hougang", "Jalan Bahar",
      "Jurong East", "Jurong Island", "Jurong West", "Kallang", "Lim Chu Kang", "Mandai", "Marine Parade", "Novena",
      "Pasir Ris", "Paya Lebar", "Pioneer", "Pulau Tekong", "Pulau Ubin", "Punggol", "Queenstown", "Seletar", "Sembawang",
      "Sengkang", "Sentosa", "Serangoon", "Southern Islands", "Sungei Kadut", "Tampines", "Tanglin", "Tengah", "Toa Payoh",
      "Tuas", "Western Islands", "Western Water Catchment", "Woodlands", "Yishun"
    ];

    const totalCells = 47; // 47 region
    let selectedCard = null;

    for (let i = 0; i < totalCells; i++) {
      const smallFlexbox = document.createElement('div');
      smallFlexbox.className = 'small-flexbox';

      const card = document.createElement('div');
      card.className = 'card';

      if (regions[i]) {
        card.innerHTML = `<div class="region-name">${regions[i]}</div>`;
        card.addEventListener('click', () => {
          if (selectedCard) selectedCard.classList.remove('selected');
          card.classList.add('selected');
          selectedCard = card;
          fetchWeather(regions[i]);
        });
      } else {
        card.innerHTML = `<div class="region-name">â€”</div>`;
        card.addEventListener('click', () => {
          if (selectedCard) selectedCard.classList.remove('selected');
          card.classList.add('selected');
          selectedCard = card;
          regionName.textContent = "No Region Selected";
          weatherInfo.textContent = "No data available";
          weatherIcon.textContent = "âŒ";
          timeInfo.textContent = "";
        });
      }

      smallFlexbox.appendChild(card);
      regionTable.appendChild(smallFlexbox);
    }

    function fetchWeather(region) {
      fetch("https://api.data.gov.sg/v1/environment/2-hour-weather-forecast")
        .then(response => response.json())
        .then(data => {
          const forecast = data.items[0].forecasts.find(f => f.area === region);
          const start = data.items[0].valid_period.start;
          const end = data.items[0].valid_period.end;

          regionName.textContent = region;

          if (forecast) {
            const forecastText = forecast.forecast;
            weatherInfo.textContent = forecastText;
            weatherIcon.textContent = weatherEmojis[forecastText] || "ğŸŒˆ";
            timeInfo.textContent =
              "From: " + new Date(start).toLocaleTimeString() +
              " To: " + new Date(end).toLocaleTimeString();
          } else {
            weatherInfo.textContent = "No data available";
            weatherIcon.textContent = "â“";
            timeInfo.textContent = "";
          }
        })
        .catch(error => {
          weatherInfo.textContent = "Error fetching data";
          weatherIcon.textContent = "âš ï¸";
          timeInfo.textContent = "";
          console.error(error);
        });
    }
  </script>

</body>
</html>
